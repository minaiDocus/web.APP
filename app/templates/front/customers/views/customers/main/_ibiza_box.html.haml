.ibizabox_content

  %ul#ibizabox_tab.nav.nav-tabs.ms-3{role: "tablist"}
    %li.nav-item.no-margin{role: "presentation"}
      %button#ibizabox_folders_list_tab.semibold.nav-link{"aria-controls" => "ibizabox_folders_list", "aria-selected" => "true", "data-bs-target" => "#ibizabox_folders_list", "data-bs-toggle" => "tab", role: "tab", type: "button", class: ('active show' if (params[:tab] == 'ibiza_box' && (params[:subtab].blank? || params[:subtab] == 'ibizabox_folders_list')))}
        Liste des répertoires accessibles
        %span.badge.bg-secondary= @customer.ibizabox_folders.count
    %li.nav-item.no-margin{role: "presentation"}
      %button#ibizabox_documents_historic_tab.semibold.nav-link.ibizabox_documents.historic{"aria-controls" => "ibizabox_documents_historic", "aria-selected" => "false", "data-bs-target" => "#ibizabox_documents_historic", "data-bs-toggle" => "tab", role: "tab", type: "button", link: organization_customer_ibizabox_documents_path(@organization, @customer), class: ('active show' if (params[:tab] == 'ibiza_box' && params[:subtab] == 'historic'))} Historique des documents
    %li.nav-item.no-margin{role: "presentation"}
      %button#select_ibizabox_documents_tab.semibold.nav-link.ibizabox_documents.select{"aria-controls" => "select_ibizabox_documents", "aria-selected" => "false", "data-bs-target" => "#select_ibizabox_documents", "data-bs-toggle" => "tab", role: "tab", type: "button", link: select_organization_customer_ibizabox_documents_path(@organization, @customer), class: ('active show' if (params[:tab] == 'ibiza_box' && params[:subtab] == 'select'))} Sélection des documents

  #ibizabox_tab_content.tab-content
    #ibizabox_folders_list.tab-pane.box.no-margin.fade{"aria-labelledby" => "ibizabox_folders_list_tab", role: "tabpanel", class: ('active show' if (params[:tab] == 'ibiza_box' && (params[:subtab].blank? || params[:subtab] == 'ibizabox_folders_list')))}
      .w-100.text-end.no-margin
        = link_to 'Rafraîchir', refresh_organization_customer_ibizabox_folders_path(@organization, @customer), method: :patch, class: 'btn btn-primary margin1right'  
      %table.table.table-striped.table-condensed.margin1bottom.table-bordered-inner.table-detachable-head
        %thead
          %tr.bg-brown.text-white
            %th Code journal idocus
            %th Répertoire Ibiza
            %th Périodes accessibles
            %th Statut
            %th Actions
        %tbody.retractable.slidedown
          - ibiza_journals = FileImport::Ibizabox.get_accessible_journals(@customer)
          - @customer.ibizabox_folders.includes(:journal).each do |folder|
            - journal = folder.journal
            %tr
              %td
                = journal.name
                - unless ibiza_journal_accessible?(folder, ibiza_journals)
                  %i
                    %strong (Journal inexistant ou inaccessible depuis la ged ibiza)
              %td= journal.use_pseudonym_for_import ? journal.pseudonym : journal.name
              %td= FileImport::Ibizabox.new(folder).accessible_ibiza_periods.join(" - ")
              %td= ibizabox_folder_state(folder)
              %td
                - if ibiza_journal_accessible?(folder, ibiza_journals)
                  = link_to "#{folder.active? ? 'Désactiver' : 'Activer'}", organization_customer_ibizabox_folder_path(@organization, @customer, folder), method: 'patch', class: "btn btn-light btn-#{folder.active? ? 'danger' : 'primary'}"
                - else
                  = link_to "Journal ibiza inaccessible", '#', class: "btn btn-light btn-primary", disabled: true
    #ibizabox_documents_historic.tab-pane.box.no-margin.fade{"aria-labelledby" => "ibizabox_documents_historic_tab", role: "tabpanel", class: ('active show' if (params[:tab] == 'ibiza_box' && params[:subtab] == 'historic'))}
      .historic_content
    #select_ibizabox_documents.tab-pane.box.no-margin.fade{"aria-labelledby" => "select_ibizabox_documents_tab", role: "tabpanel", class: ('active show' if (params[:tab] == 'ibiza_box' && params[:subtab] == 'select'))}
      .select_content
