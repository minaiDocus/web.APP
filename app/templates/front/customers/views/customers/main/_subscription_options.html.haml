#packages_price
  %input{ id: 'subscription_packages_price', type: 'hidden', value: Subscription::Package::PRICES_LIST.to_json }
#personalize_subscription_package_form
  - if @subscription
    - current_package = @subscription.futur_packages.present? ? @subscription.futur_packages : @subscription.current_packages
  - else
    - current_package = []

  .center{ style: "text-align: center" }
    .notify-warning.fs-origin.mb-3{ class: "#{(@subscription && @subscription.futur_packages.present? && @subscription.futur_packages != '[]') ? '' : 'hide' }" }
      Disparaîtra le mois prochain
  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{ class: "#{'notify-warning' if notify_warning(@subscription, 'ido_x')}", title: Subscription::Package.infos_of(:ido_x)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-x.bold iDo'X
    .col-md-6
      .semibold.description Convertissez les pièces venues de Jefacture.com (factur-X) en écritures comptables !    
      %p Attention les autres modes d’import ne sont pas disponibles. Seul les fichiers venant de jefacture.com sont autorisés. 
    .col-md-3
      .row
        .col-md-2.text-center
          %span.no-price.price.bold 10€
        .col-md-6.text-end
          %label.price.bold 5€/mois
          %br
          %i.remark offre de lancement
        .col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'ido_x', current_package.include?('ido_x'), class: 'form-check-input ido_x radio-button', data: { package: "ido_x" }
  .row.ido-x-content.p-4.hide
    .col-md-6
      .form-group
        = label_tag 'user[jefacture_account_id]', "Identifiant Jefactrure (SIREN)", class: 'col-form-label semibold'
        .select-container.no-padding.w-100
          = text_field_tag 'user[jefacture_account_id]', @customer.jefacture_account_id, class: 'form-control ido_x_option option_checkbox', disabled: !current_package.include?('ido_x'), placeholder: "ex : 278 254 652"
    .col-md-6
      .form-group
        = label_tag 'subscription[number_of_journals]', "Nombre de journaux", class: 'control-label required semibold'
        .select-container.no-padding.w-100
          .subscription_number_of_journals
            = number_field_tag 'subscription[number_of_journals]', @subscription.try(:number_of_journals).presence || 5, class: 'form-control col-md-3 special_input ', min: 5, max: 30, style: 'font-weight:bold;margin-left: 20px', required: true, autofocus: true, pattern: '/^[0-9]+$/', placeholder: "5"
            &nbsp;
            %span{id: 'err-msg-input-number'}
            - if @customer.account_book_types.count > 5
              %div{ style: "clear:both;" }
                %i Supprimez un journal comptable avant de baisser cette option.
  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{class: "#{'notify-warning' if notify_warning(@subscription, 'ido_nano')}", title: Subscription::Package.infos_of(:ido_nano)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-micro.bold iDo'Nano
    .col-md-6
      .semibold.description Transférez jusqu’à 100 pièces par an et benéficiez des automates de récupérations bancaires et documentaires.   
      %p Au-delà de 100 factures, calcul du dépassement simplifié ; 0,25€ HT/facture
    .col-md-3
      .row
        .col-md-8.text-end                  
          %label.price.bold 10€/mois
        .W-2.col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'ido_nano', current_package.include?('ido_nano'), class: "form-check-input ido_nano radio-button #{'commitment_pending' if @customer.persisted? && !@customer.try(:subscription).try(:commitment_end?)}", data: { package: "ido_nano" }

  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{class: "#{'notify-warning' if notify_warning(@subscription, 'ido_micro')}", title: Subscription::Package.infos_of(:ido_micro)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-micro.bold iDo’Micro
    .col-md-6
      .semibold.description Transférez jusqu’à 100 pièces par an et benéficiez des automates de récupérations bancaires et documentaires.   
      %p Au-delà de 100 factures, calcul du dépassement simplifié ; 0,25€ HT/facture
    .col-md-3
      .row
        .col-md-8.text-end                  
          %label.price.bold 10€/mois
        .W-2.col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'ido_micro', current_package.include?('ido_micro'), class: "form-check-input ido_micro radio-button #{'commitment_pending' if @customer.persisted? && !@customer.try(:subscription).try(:commitment_end?)}", data: { package: "ido_micro" }
  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{ class: "#{'notify-warning' if notify_warning(@subscription, 'ido_mini')}", title: Subscription::Package.infos_of(:ido_mini)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-micro.bold iDo'Mini
    .col-md-6
      .semibold.description Transférez jusqu’à 100 pièces par an et benéficiez des automates de récupérations bancaires et documentaires.   
      %p Au-delà de 100 factures, calcul du dépassement simplifié ; 0,25€ HT/facture
    .col-md-3
      .row
        .col-md-8.text-end                  
          %label.price.bold 10€/mois
        .W-2.col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'ido_mini',current_package.include?('ido_mini'), class: "form-check-input ido_mini radio-button #{'commitment_pending' if @customer.persisted? && !@customer.try(:subscription).try(:commitment_end?)}", data: { package: "ido_mini" }
  
  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{ class: "#{'notify-warning' if notify_warning(@subscription, 'ido_classique')}", title: Subscription::Package.infos_of(:ido_classique)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-basic.bold iDo’Classique
    .col-md-6
      .semibold.description Transférez jusqu’à 100 pièces par an et mutualisez des quotas au niveau du cabinet.  
      %p Au-delà du quota cabinet simplifié : 0,25€ HT/facture
    .col-md-3
      .row
        .col-md-8.text-end
          %label.price.bold 11€/mois
        .col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'ido_classique', ((@subscription && current_package.include?('ido_classique')) || !@subscription), class: 'form-check-input ido_classique radio-button', data: { package: "ido_classique" }

  .ido-basic-content.p-4
    .row
      .col-md-6()
        .row
          .col-md-10.form-group
            .form-check.form-check-inline{class: "#{'notify-warning' if notify_warning(@subscription, 'ido_classique', 'retriever_option')}", title: Subscription::Package.infos_of(:retriever_option)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
              %label.semibold Avec option  automate
          .col-md-2.form-check.form-switch
            %label.form-check-label Oui
            = check_box_tag 'subscription[retriever_option]', true, (current_package.include?('ido_classique') && current_package.include?('retriever_option')), class: "form-check-input input-toggle option_checkbox ido_classique_option #{'active_option' if (current_package.include?('ido_classique') && current_package.include?('retriever_option'))}", data: { retriever_price_option: @subscription.try(:retriever_price_option).to_s.presence || 'retriever' }, disabled: (!current_package.include?('ido_classique') && @subscription)

        .row
          .col-md-10.form-group
            .form-check.form-check-inline{class: "#{'notify-warning' if notify_warning(@subscription, 'ido_classique', 'mail_option')}", title: Subscription::Package.infos_of(:mail_option)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
              %label.semibold Avec option courrier
          .col-md-2.form-check.form-switch
            %label.form-check-label Non
            = check_box_tag 'subscription[mail_option]', true, (current_package.include?('ido_classique') && current_package.include?('mail_option')), class: "form-check-input option_checkbox input-toggle ido_classique_option #{'active_option' if (current_package.include?('ido_classique') && current_package.include?('mail_option'))}", data: { package: "mail_option" }, disabled: (!current_package.include?('ido_classique') && @subscription)

        .row
          .col-md-10.form-group
            .form-check.form-check-inline.pre_assignment{ class: "#{'notify-warning' if notify_warning(@subscription, @subscription.try(:current_package?).to_s, 'pre_assignment_option')} #{'hide' if ((@subscription && !@subscription.is_package?('ido_mini') && !@subscription.is_package?('ido_classique')) || ( @subscription && @subscription.try(:futur_packages).present? && !(@subscription.futur_packages.include?('ido_mini') || @subscription.futur_packages.include?('ido_classique'))))}", style: "#{'padding-top: 1.5%' if notify_warning(@subscription, @subscription.try(:current_package?).to_s, 'pre_assignment_option')}" }
              %label.semibold Pré-saisie comptable
          .col-md-2.form-check.form-switch
            %label.form-check-label.pre-assignment-state{title: 'Pré-saisie comptable activée', data: { toggle: 'tooltip', placement: 'bottom' }} Oui
            = check_box_tag 'subscription[is_pre_assignment_active]', true, (!@subscription || current_package.include?('pre_assignment_option')), class: "is_pre_assignment_active_true is_pre_assignment_active radio-button form-check-input option_checkbox input-toggle", data: { package: "mail_option" }, disabled: (!current_package.include?('ido_classique') && @subscription)

      .col-md-6
        .form-group
          = label_tag 'subscription[number_of_journals]', "Nombre de journaux", class: 'control-label required semibold'
          .select-container.no-padding.w-100
            .subscription_number_of_journals
              = number_field_tag 'subscription[number_of_journals]', @subscription.try(:number_of_journals).presence || 5, class: 'form-control col-md-3 special_input ', min: 5, max: 30, style: 'font-weight:bold;margin-left: 20px', required: true, autofocus: true, pattern: '/^[0-9]+$/', placeholder: "5"
              &nbsp;
              %span{id: 'err-msg-input-number'}
              - if @customer.account_book_types.count > 5
                %div{ style: "clear:both;" }
                  %i Supprimez un journal comptable avant de baisser cette option.

  
  .row.box
    .col-md-3.text-center
      .form-check.form-check-inline{ class: "#{'notify-warning' if notify_warning(@subscription, 'retriever_option')}", title: Subscription::Package.infos_of(:retriever_option)[:tooltip], data: { toggle: 'tooltip', placement: 'right' }}
        .label-package.label-ido-retriever.bold.no-padding- Automate
    .col-md-6
      .semibold.description Bénéficiez des automates de récupération bancaires et documentaires.                    
    .col-md-3
      .row
        .col-md-8.text-end
          %label.price.bold 5€/mois
        .col-md-4.text-center
          = radio_button_tag 'subscription[subscription_option]', 'retriever_option', (current_package.include?('retriever_option') && !current_package.include?('ido_classique') && !current_package.include?('ido_mini') && !current_package.include?('ido_micro') && !current_package.include?('ido_x')), class: 'form-check-input retriever-uniquess-check-radio radio-button', data: { retriever_price_option: @subscription.try(:retriever_price_option).to_s.presence || 'retriever' }

  .row
    .col-md-10.form-group
      = label_tag 'subscription[is_to_apply_now]', "Appliquer tout de suite les options à la baisse ?", class: 'semibold'
    .col-md-2.form-check.form-switch
      %label.form-check-labelpre-assignment-state{title: 'Pré-saisie comptable activée', data: { toggle: 'tooltip', placement: 'bottom' }} Oui
      = check_box_tag 'subscription[is_to_apply_now]', true, true, class: 'form-check-input option_checkbox input-toggle'

  
  %hr
  .row.w-100
    .text-end
      %h4 Prix du forfait avec les options sélectionnées :
      %b.total_price{ style: 'font-size:20px' }


.input-journal-numbers.hide
  .form-group
    = label_tag 'subscription[number_of_journals]', "Nombre de journaux", class: 'control-label required semibold'
    .select-container.no-padding.w-100
      .subscription_number_of_journals
        = number_field_tag 'subscription[number_of_journals]', @subscription.try(:number_of_journals).presence || 5, class: 'form-control col-md-3 special_input ', min: 5, max: 30, style: 'font-weight:bold;margin-left: 20px', required: true, autofocus: true, pattern: '/^[0-9]+$/', placeholder: "5"
        &nbsp;
        %span{id: 'err-msg-input-number'}
        - if @customer.account_book_types.count > 5
          %div{ style: "clear:both;" }
            %i Supprimez un journal comptable avant de baisser cette option.
