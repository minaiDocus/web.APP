= stylesheet_link_tag 'front/organizations/assets/stylesheets/show'

%input#organization_id{type: :hidden, value: @organization.id, name: 'organization_id'}

.book
  .row.derivationRight
    .col-md-10
      %h3.bold
        Journaux comptables
        %span.badge.badge-secondary.badge-sm.regular= @journals.total_count
    .col-md-2.text-center
      %button.btn.btn-primary.bold.new-journal.new_edit_account_book_type{link: new_organization_journal_path(@organization)}
        %span.me-2= glyphicon('plus', { color: "#FFF", size: '15'})       
        %span Nouveau journal

  
  .box.mt-4.derivationLeft
    %table.table.table-striped.table_integration
      %thead
        %th Nom du journal comptable
        %th Code
        %th Par défaut ?
        %th Type de pré-saisie
        %th Type de compte
        %th Compte de tiers
        %th Compte de charge/produit
        %th.text-end Action
      %tbody
        - @journals.each do |journal|
          %tr
            %td.semibold= journal.description
            %td= journal.name
            %td= journal.is_default ? 'Oui' : 'Non'
            %td= t("activerecord.models.account_book_type.attributes.entry_type_#{journal.entry_type}")
            %td
              - if journal.is_pre_assignment_processable?
                = journal.default_account? ? 'compte par défaut' : "compte d'attente"
            %td= journal.meta_account_number
            %td= journal.meta_charge_account
            %td.text-end.pointer
              .action.sub-menu-book
                %span= glyphicon('ellipses', { size: '15', color: 'rgba(26, 26, 26, 0.7);', style: 'transform: rotate(90deg)'})
              .sub_menu.edit-journal.text-start.hide
                %ul.no-margin.no-padding.regular                 
                  %li.edit{journal_id: journal.id}
                    = link_to glyphicon('pencil', { size: '15', color: 'rgba(26, 26, 26, 0.7);'}) + ' Éditer', '#', link: edit_organization_journal_path(@organization, journal), class: 'new_edit_account_book_type'
                  %li.delete.red-label
                    = link_to glyphicon('trash', { size: '15', color: "#FF4848" }) + ' Supprimer', organization_journal_path(@organization, journal), method: 'delete', data: { confirm: t('actions.confirm') }

    = render file: Rails.root.join('app/views/shared/_pagination.html.haml'), locals: { name: 'journales', total_pages: @journals.total_pages } 

  .modal#journal-form
    .modal-dialog
      .modal-content
        .modal-header
          %h5.modal-title.bold Nouveau journal comptable
          %button.btn-close{'aria-label' => 'Close', 'data-bs-dismiss' => 'modal', :type => 'button'}
        .modal-body

        .modal-footer
          .row.w-100.previous-next-controls
            .col-md-8.d-inline-block
              %button.btn.btn-default.semibold.previous.hide{ type: :button, "data-bs-target" => "#carousel-journal-form", "data-bs-slide" => "prev" } Précedent       
            .col-md-4.d-inline-block.ps-1.text-end
              %button.btn.btn-light.cancel.me-1.semibold{ type: :button, 'aria-label' => 'Close', 'data-bs-dismiss' => 'modal' } Annuler
              %button.btn.btn-primary.semibold.next{ type: :button, "data-bs-target" => "#carousel-journal-form", "data-bs-slide" => "next" } Suivant
              %button.btn.btn-primary.semibold.validate.hide{ type: :submit } Valider

= javascript_include_tag 'front/journals/assets/javascripts/main'